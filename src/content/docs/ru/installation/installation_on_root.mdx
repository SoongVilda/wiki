---
title: Как установить CachyOS и руководство по разбивке диска
description: Установка с очисткой диска
---

import { Steps, Tabs, TabItem } from '@astrojs/starlight/components';

:::caution
Secure boot должен быть отключен при установке CachyOS. Чтобы настроить secure boot после установки, смотрите [Настройка Secure Boot.](/ru/configuration/secure_boot_setup)
:::

:::tip
Настоятельно рекомендуется перезагрузить ISO после неудачной попытки установки.

В противном случае во время установки могут возникать постоянные ошибки.

Это происходит потому, что установщик неправильно отключает разделы при неудачной установке.

:::

## Очистка диска

Опция "Очистить диск" в Calamares сотрет выбранный диск и установит CachyOS на целевой диск.

<Steps>

1. Загрузитесь в ISO и нажмите **Launch Installer**.

2. Выберите предпочтительный **Boot Manager**. Подробнее смотрите в разделе [Boot Managers](/ru/installation/boot_managers).

3. Установите предпочтительный **Language** и **Region/Timezone**.

4. Настройте **Keyboard Layout**.

5. Выберите **Erase Disk** и выберите [Filesystem](/ru/installation/filesystem).

6. Выберите **Desktop Environment**, смотрите [Desktop Environments](/ru/installation/desktop_environments).

7. Настройте, какие пакеты следует или не следует устанавливать во время установки.

8. Настройте учетные данные для входа.

9. Внимательно просмотрите сводку по установке на странице обзора. Если все выглядит правильно, продолжите установку, нажав ***Install Now***. В противном случае вернитесь назад и внесите необходимые изменения.

</Steps>

## Ручная разбивка диска

### UEFI/GPT

Таблица разделов для каждого загрузчика отличается. Пожалуйста, следуйте правильным инструкциям для каждого из них.

<Tabs>

<TabItem label='systemd-boot & rEFInd & Limine'>

<Steps>

1. Загрузитесь в ISO и нажмите кнопку **Launch Installer**.

2. Установите предпочтительный **Language** и **Region/Timezone**.

3. Настройте **Keyboard Layout**.

4. Выберите **Manual partitioning**.

5. Создайте новый раздел со следующими параметрами:
    * Size: ***2048MiB***
    * Filesystem: ***FAT32***
    * Mount point: ***/boot***
    * Flags: **boot**

6. Создайте еще один раздел для ***root***:
    * Size: ***At least 20000MiB***
    * Filesystem: Any, смотрите [Filesystem](/ru/installation/filesystem)
    * Mount point: ***/***
    * Flags:

7. Дважды проверьте, что ***Install boot loader on:*** указывает на /boot

8. Выберите **Desktop Environment**, смотрите [Desktop Environments](/ru/installation/desktop_environments).

9. Настройте, какие пакеты следует или не следует устанавливать во время установки.

10. Настройте учетные данные для входа.

11. Внимательно просмотрите сводку по установке на странице обзора. Если все выглядит правильно, продолжите установку, нажав ***Install Now***. В противном случае вернитесь назад и внесите необходимые изменения.

</Steps>

</TabItem>

<TabItem label='GRUB'>

<Steps>

1. Загрузитесь в ISO и нажмите кнопку **Launch Installer**.

2. Установите предпочтительный **Language** и **Region/Timezone**.

3. Настройте **Keyboard Layout**.

4. Выберите **Manual partitioning**.

5. Создайте новый раздел со следующими параметрами:
    * Size: ***At least 100MiB***
    * Filesystem: ***FAT32***
    * Mount point: ***/boot/efi***
    * Flags: **boot**

6. Создайте еще один раздел для ***root***:
    * Size: ***At least 20000MiB***
    * Filesystem: Any, смотрите [Filesystem](/ru/installation/filesystem)
    * Mount point: ***/***
    * Flags:

7. Дважды проверьте, что ***Install boot loader on:*** указывает на /boot/efi

8. Выберите **Desktop Environment**, смотрите [Desktop Environments](/ru/installation/desktop_environments).

9. Настройте, какие пакеты следует или не следует устанавливать во время установки.

10. Настройте учетные данные для входа.

11. Внимательно просмотрите сводку по установке на странице обзора. Если все выглядит правильно, продолжите установку, нажав ***Install Now***. В противном случае вернитесь назад и внесите необходимые изменения.

</Steps>

</TabItem>

</Tabs>

### MBR/BIOS

:::note
GRUB - единственный загрузчик, доступный для системы MBR/BIOS.
:::

<Steps>

1. Загрузитесь в ISO и нажмите кнопку **Launch Installer**.

2. Установите предпочтительный **Language** и **Region/Timezone**.

3. Настройте **Keyboard Layout**.

4. Выберите **Manual partitioning**.

5. Создайте новый раздел со следующими параметрами:
    * Size: ***At least 20000MiB***
    * Filesystem: Any, смотрите [Filesystem](/ru/installation/filesystem)
    * Mount point: ***/***
    * Flags:

6. Дважды проверьте, что ***Install boot loader on:*** указывает на ваш загрузочный диск, например: /dev/sda

7. Выберите **Desktop Environment**, которое вы хотите использовать, смотрите [Desktop Environments](/ru/installation/desktop_environments).

8. Выберите конкретные пакеты, которые вы хотите установить, из предоставленного списка и снимите выбор с тех, которые вам не нужны.

9. Настройте свои учетные данные для входа.

10. Внимательно просмотрите сводку по установке на странице обзора. Если все настройки выглядят правильно, продолжите установку, нажав ***Install Now***. В противном случае вернитесь назад и внесите необходимые изменения.

</Steps>

## Двойная загрузка

*После ручной разбивки диска может потребоваться дополнительная настройка для настройки системы с двойной загрузкой, особенно с `systemd-boot` и `GRUB`.*

<Tabs>
    <TabItem label='systemd-boot'>
        *Нам нужно скопировать двоичные файлы Windows EFI в раздел Linux EFI, чтобы загрузчик мог их распознать.*

        <Steps>
        1. Найдите `Windows EFI partition` с помощью `lsblk`

            ```sh title='Example'
            ❯ lsblk -o NAME,FSTYPE,SIZE,MOUNTPOINT
            NAME        FSTYPE   SIZE MOUNTPOINT
            zram0               15.3G [SWAP]
            nvme0n1            476.9G
            ├─nvme0n1p1 vfat     100M
            ├─nvme0n1p2           16M
            ├─nvme0n1p3 ntfs   234.4G
            ├─nvme0n1p4 ntfs     830M
            ├─nvme0n1p5 vfat       2G /boot
            └─nvme0n1p6 btrfs  239.6G /var/tmp
            ```

            *Разделы EFI почти всегда отформатированы как `FAT32/vfat`, и поскольку nvme0n1p1 не имеет точки монтирования Linux, предположим, что этот раздел является `Windows EFI partition`.*

        2. Временно смонтируйте `Windows EFI partition`.

            ```sh
            ❯ sudo mount /dev/nvme0n1p1 /mnt/WinBoot # Замените `nvme0n1p1` на раздел EFI-раздела Windows
            ```

        3. Скопируйте двоичные файлы EFI из `Windows EFI partition` в `Linux EFI partition`.

            ```sh
            ❯ sudo cp -r /mnt/WinBoot/EFI/* /boot/EFI
            ```

        4. Отключите ранее смонтированный раздел, и Windows должна появиться в меню загрузки при следующем запуске.

            ```sh
            ❯ sudo umount /mnt/WinBoot
            ```

        </Steps>
    </TabItem>

    <TabItem label='GRUB'>
        *GRUB использует os-prober для автоматического обнаружения раздела Windows EFI и добавления его в меню загрузки.*

        <Steps>
        1. Установите и выполните `os-prober`

            ```sh
            ❯ sudo pacman -S os-prober
            ❯ sudo os-prober
            ```

        2. Включите `os-prober` в файле конфигурации GRUB

            ```sh title='Нажмите CTRL+S, чтобы сохранить, и CTRL+Q, чтобы выйти из Micro'
            ❯ sudo micro /etc/default/grub
            # /etc/default/grub
            # Probing for other operating systems is disabled for security reasons. Read
            # documentation on GRUB_DISABLE_OS_PROBER, if still want to enable this
            # functionality install os-prober and uncomment to detect and include other
            # operating systems.
            GRUB_DISABLE_OS_PROBER=false

            ❯ sudo grub-mkconfig -o /boot/grub/grub.cfg
            ```

            **Windows теперь должна быть добавлена в меню загрузки.**

        </Steps>
    </TabItem>
</Tabs>

## Больше информации

- [Пошаговое руководство по установке двойной загрузки от Lord Vexy с помощью загрузчика rEFInd](https://www.youtube.com/watch?v=0Toaq3Vn5qs)
