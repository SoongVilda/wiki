---
title: Руководство по играм в CachyOS
description: 'Охватывает установку необходимых пакетов, игры в Steam с помощью Proton, различные варианты версий Proton, Lutris как центральный хаб для всех игр и установщики скриптов для популярных игр.'
---

import MultipleImageComponent from '~/components/multiple-images-component.astro';
import { Tabs, TabItem, Steps } from '@astrojs/starlight/components';

Добро пожаловать в руководство по играм в CachyOS. Мы проведем вас через основные аспекты настройки всего необходимого для отличного игрового опыта.

## Необходимые условия

:::caution
Прежде чем мы перейдем к самому интересному, важно убедиться, что драйверы вашей видеокарты установлены и работают правильно. Если ваша видеокарта работает неоптимально, у вас могут возникнуть проблемы при игре.
:::

### Необходимые пакеты

Чтобы упростить вам задачу, CachyOS сгруппировала все необходимые пакеты для игр в один мета-пакет, который включает в себя все необходимые зависимости и библиотеки для игр в Linux, и отдельный пакет для инструментов и лаунчеров/магазинов. Это делает процесс установки и настройки игр более быстрым и менее запутанным для всех.

*Если вы обнаружите, что какие-либо пакеты отсутствуют, сообщите об этом команде CachyOS.*

Выполните следующие шаги, чтобы начать настройку игр.
<Tabs>
    <TabItem label='Мета-пакет'>
        ```sh
        sudo pacman -S cachyos-gaming-meta
        ```
    </TabItem>
    <TabItem label='Инструменты и магазины'>
        *Этот пакет включает в себя следующее:*
            - Gamescope, Goverlay, Heroic Games Launcher, Lutris, MangoHud и Steam.
        ```sh
        sudo pacman -S cachyos-gaming-applications
        ```
    </TabItem>
    <TabItem label= 'CachyOS Hello'>
    - Перейдите в **Apps/Tweaks** и нажмите `Install Gaming packages`

    *CachyOS Hello устанавливает оба пакета `cachyos-gaming-meta` и `cachyos-gaming-applications`*
    </TabItem>
</Tabs>

## FAQ и советы по Steam

:::note
Пользователям ноутбуков с дискретными видеокартами NVIDIA следует обратиться к следующему [руководству](/ru/configuration/dual_gpu/)
:::

:::tip
CachyOS предоставляет различные версии Proton, которые мы собираем и поддерживаем для дальнейшего повышения производительности:
- `proton-cachyos` `(входит в пакет cachyos-gaming-meta)` - это версия, которую мы разрабатываем с добавленными изменениями QoL + тщательно отобранными патчами + оптимизациями компиляции `(x86-64-v3 & x86-64-v4)`
- `proton-ge-custom`, `proton-tkg-git`, `proton-experimental` и `proton stable releases` собраны с использованием нативных библиотек.
- `proton-ge-custom-bin` взят из AUR.
:::

:::tip
Чтобы проверить, совместима ли ваша игра с Linux или как она работает, посетите [proton-db](https://www.protondb.com/) или [Are We Anti-Cheat Yet?](https://areweanticheatyet.com/).
:::

### Какую версию Proton следует использовать в Steam?

- [`proton-cachyos`](https://github.com/CachyOS/proton-cachyos) Настоятельно рекомендуется использовать версию, которую мы собираем и поддерживаем, если только у нее нет проблем с игрой, в которую вы хотите играть. Должен работать в большинстве случаев.
- `Proton Experimental` Самая новая версия от `Valve`. Если игра, в которую вы хотите играть, относительно новая или она плохо работает с текущей стабильной версией Proton, или, возможно, вы видели, что люди рекомендуют ее в [ProtonDB](https://www.protondb.com/).
- `Proton 9.0.4 или ниже` Стабильные версии от `Valve`. Если игра, в которую вы хотите играть, работает только в предыдущей версии Proton.
- `Proton-GE` Сборка, сделанная [GloriousEggroll](https://github.com/GloriousEggroll/proton-ge-custom), в некоторых случаях она пригодится.

### Как правильно установить несколько параметров запуска
Параметры запуска в Steam строятся по следующей схеме
- `<переменные среды> <обертки> %command% <аргументы приложения>`
    - `<переменные среды>`: Это параметры в форме `VARIABLE=value`. Например, `PROTON_DXVK_D3D8=1` или `DXVK_HUD="fps,memory,version,api"`
    - `<обертки>`: Приложения и скрипты, которые изменяют способ запуска реального приложения. Аргументы для обертки обычно идут после исполняемого файла обертки. Например, `mangohud --dlsym` или `gamescope -W 1680 -H 1050 -w 1280 -h 720 -S fit -F fsr --mangoapp --`
    - `%command%`: Это реальное приложение. Его следует указывать именно так, как есть, и Steam заменит его правильной командой при запуске приложения.
    - `<аргументы приложения>`: Это различные аргументы для реального приложения, и они зависят от приложения. Например, `-dx11` следует указывать здесь, если приложение поддерживает его.

- Пример: `__GL_SHADER_DISK_CACHE_SKIP_CLEANUP=1 prime-run game-performance %command% -dx11`

:::caution
Не добавляйте несколько `%command%`, используя их в качестве разделителей для нескольких параметров запуска.

Пример: `__GL_SHADER_DISK_CACHE_SKIP_CLEANUP=1 %command% game-performance %command% prime-run %command%`
    - В этом случае все, что находится после первого `%command%`, будет проигнорировано, потому что это рассматривается как аргументы игры, поэтому только `__GL_SHADER_DISK_CACHE_SKIP_CLEANUP=1` распознается как параметр запуска.
:::

### Исправление заикания, вызванного функцией записи игр Steam

```sh title='Добавьте следующий параметр запуска в свою игру'
LD_PRELOAD="" %command%
```

## Советы по производительности

### Переключение профиля питания по требованию

:::note
Это поведение немного отличается с `intel_pstate`. На Intel губернатор остается в режиме энергосбережения, но
значения EPP/EPB установлены на производительность.
:::

CachyOS предоставляет скрипт-обертку [`game-performance`](https://github.com/CachyOS/CachyOS-Settings/blob/master/usr/bin/game-performance)
который использует `power-profiles-daemon` для временного переключения текущего профиля питания на `performance`.
Профиль `performance` увеличивает уровни мощности системы и изменяет губернатор ЦП на `performance`.

Когда этот скрипт используется для запуска игры, система будет настроена на использование профиля `performance` до тех пор, пока игра запущена.
Ранее использовавшийся профиль питания будет восстановлен после закрытия игры.

*[Feral's GameMode](https://github.com/FeralInteractive/gamemode)
имеет аналогичное поведение, но его не следует использовать, поскольку CachyOS уже поставляется с [`ananicy-cpp`](https://gitlab.com/ananicy-cpp/ananicy-cpp)*

### Как добавить game-performance в Steam, Lutris и Heroic Games Launcher

<Tabs>

<TabItem label='Steam'>

<Steps>
1. Откройте свою `Библиотеку Steam`
2. Щелкните правой кнопкой мыши по названию игры и выберите `Свойства`.
3. На вкладке `Общие` вы найдете раздел `Параметры запуска`.
4. Добавьте следующий параметр запуска:
    ```sh
    game-performance %command%
    ```
</Steps>

</TabItem>

<TabItem label='Heroic Games Launcher'>

<Steps>
1. На левой панели откройте `Настройки`.
2. Перейдите в `Настройки игры` и нажмите `Дополнительно`.
3. В разделе команды `wrapper`. Добавьте следующую строку без каких-либо аргументов:
   ```sh
   game-performance
   ```
4. Нажмите на знак `+`, чтобы сохранить изменения.
</Steps>

</TabItem>

<TabItem label='Lutris'>

<Steps>
1. В правом верхнем углу откройте `меню-гамбургер`
2. Перейдите в `Настройки/Глобальные параметры`.
3. Включите `Расширенный режим` в правом верхнем углу.
4. Прокрутите вниз до `Префикса команды` и добавьте следующую строку:
   ```sh
   game-performance
   ```
5. Сохраните изменения.
</Steps>

</TabItem>

</Tabs>

## Proton-CachyOS

Proton-CachyOS основан на `новейшей` ветке Proton и применяет к ней ряд модификаций.
- **Патчи Wine-staging**
- **Wine Fullscreen FSR**
- **Включает видео- и аудиокодеки для игровых катсцен**
- **Поддержка `umu-launcher`, включая UMU-Protonfixes**
- **Добавляет ранние исправления/обходные пути для игр**

:::note
Пакет `proton-cachyos` из репозиториев CachyOS скомпилирован с использованием нативных системных библиотек, он не использует Steam Linux Runtime. Целевая архитектура зависит от репозитория. В настоящее время репозитории `x86_64_v3`, `x86_64_v4` и `znver4` используют одни и те же двоичные файлы `x86_64_v3`.
:::

:::caution
Если вы столкнулись с проблемами в играх, использующих **Easy Anti-Cheat** (EAC) или **BattlEye** (BE), например, отказ входа на игровые серверы, вы можете использовать версию [Proton-CachyOS, собранную с использованием Steam Linux Runtime](https://github.com/CachyOS/proton-cachyos/releases)
:::

**Дополнительные параметры конфигурации**

- `PROTON_NO_WM_DECORATION=1`: Отключает оформление окон с помощью диспетчера окон Linux. Это может исправить проблемы с **полноэкранным режимом без рамки** и щелчком мыши сквозь окно.
- `PROTON_PREFER_SDL_INPUT=1`: Включите, чтобы обойти проблемы с правильным определением контроллера.

### Настройка umu-launcher

:::note
Убедитесь, что в вашей системе установлен umu-launcher из CachyOS. Установите его с помощью следующей команды:
`sudo pacman -S cachyos/umu-launcher`

Не забудьте добавить переменную окружения `UMU_NO_RUNTIME`
:::

<Tabs>
    <TabItem label='Lutris Global'>
    <Steps>
    1. На главном экране Lutris щелкните по `шестеренке` справа от **Wine**
    2. Внесите следующие изменения на вкладке **Параметры запуска**:
        - **Версия Wine** = `proton-cachyos`
        - **Использовать системные winetricks** = *Отключено*
        - **Графика**
            - **Включить DXVK** = `Включено`
            - **Включить VKD3D** = `Включено`
            - **Включить D3D Extras** = `Включено`
            - **Включить DXVK-NVAPI / DLSS** = `Включено`
            - Пользовательские версии **DXVK**, **VKD3D** и **DXVK-NVAPI** не применяются при использовании `umu-launcher`
    3. Перейдите на вкладку **Системные параметры**
        - **Lutris**
            - **Отключить Lutris Runtime** = `Включено`
            - **Предпочитать системные библиотеки** = `Включено`
    4. Прокрутите вниз до **Выполнения игры** и найдите таблицу **Переменные среды**
    5. Добавьте следующие переменные среды:
        - **Ключ**: `UMU_NO_RUNTIME`
            - **Значение**: `1` *использовать системные библиотеки вместо steam runtime, только для proton-cachyos*
        - **Ключ**: `UMU_RUNTIME_UPDATE` *необязательно*
            - **Значение**: `0` *пропускает обновления Steam Linux Runtime для `proton-cachyos`*
        - **Ключ**: `PROTON_VERB` *необязательно*
            - **Значение**: `waitforexitandrun` *позволяет protonfixes работать с соответствующим `GAMEID`*
    6. Сохраните изменения.
    </Steps>
    </TabItem>
    <TabItem label='Lutris Per Game'>
    <Steps>
    1. Щелкните правой кнопкой мыши по игре, которую хотите настроить, затем нажмите **Настроить**
    2. Внесите следующие изменения на вкладке **Параметры запуска**:
        - **Версия Wine** = `proton-cachyos`
        - **Использовать системные winetricks** = *Отключено*
        - **Графика**
            - **Включить DXVK** = `Включено`
            - **Включить VKD3D** = `Включено`
            - **Включить D3D Extras** = `Включено`
            - **Включить DXVK-NVAPI / DLSS** = `Включено`
            - Пользовательские версии **DXVK**, **VKD3D** и **DXVK-NVAPI** не применяются при использовании `umu-launcher`
    3. Перейдите на вкладку **Системные параметры**
        - **Lutris**
            - **Отключить Lutris Runtime** = `Включено`
            - **Предпочитать системные библиотеки** = `Включено`
    4. Прокрутите вниз до **Выполнения игры** и найдите таблицу **Переменные среды**
    5. Добавьте следующие переменные среды:
        - **Ключ**: `UMU_NO_RUNTIME`
            - **Значение**: `1` *если вы используете umu-launcher `1.1.4` из CachyOS*
        - **Ключ**: `UMU_RUNTIME_UPDATE` *необязательно*
            - **Значение**: `0` *пропускает обновления Steam Linux Runtime для `proton-cachyos`*
        - **Ключ**: `PROTON_VERB` *необязательно*
            - **Значение**: `waitforexitandrun` *позволяет protonfixes работать с соответствующим `GAMEID`*
    6. Сохраните изменения.
    </Steps>
    </TabItem>
    <TabItem label='Heroic Games Launcher'>
        <Steps>
            1. Нажмите кнопку `Настроить` рядом с кнопкой `Играть сейчас` в игре, которую хотите запустить.
            2. На вкладке `WINE`. Установите для версии Wine значение `Proton - proton-cachyos`.
            3. Перейдите в `Дополнительно`. Прокрутите вниз до `Переменные среды`
            4. Добавьте `UMU_NO_RUNTIME` в поле Имя переменной со значением `1` и нажмите на знак плюса.
        </Steps>
    </TabItem>
</Tabs>

## Wine-CachyOS

Это тот же `wine`, который лежит в основе `proton-cachyos`, но в виде отдельного пакета, который можно использовать в Lutris, Heroic, Bottles и других.

- **Все модификации Wine, включенные в Proton-CachyOS**
- **Добавляет ранние исправления/обходные пути для игр**

:::note
В репозиториях CachyOS **Wine-CachyOS** представлен двумя разными пакетами. `wine-cachyos` устанавливает его как Wine по умолчанию для системы и заменяет `wine` или `wine-staging`. `wine-cachyos-opt` устанавливает его в другое место, что позволяет нескольким версиям Wine сосуществовать в системе.
:::

:::caution
Основное предназначение **Wine-CachyOS** — **игры**. Хотя его можно использовать как системный Wine с настольными приложениями, имейте в виду, что это может привести к неожиданному поведению и проблемам из-за модификаций, ориентированных на игры.

Если вы хотите использовать настольные приложения, мы рекомендуем использовать `wine` или `wine-staging` в качестве системного Wine и установить `wine-cachyos-opt` для игр.
:::

**Дополнительные параметры конфигурации**

- `WINE_WMCLASS="<имя>"`: Устанавливает `WM_CLASS` для всех окон Wine, позволяя оконному менеджеру управлять окнами Wine с помощью правил.
- `WINEUSERSANDBOX=1`: Отключает создание символических ссылок из пользовательских папок Wine, таких как Documents/Pictures, на эквивалентные папки в домашнем каталоге пользователя.
- `WINE_NO_WM_DECORATION=1`: Отключает оформление окон с помощью оконного менеджера Linux. Это может исправить проблемы с **полноэкранным режимом без рамки** и щелчком мыши сквозь окно.
- `WINE_PREFER_SDL_INPUT=1`: Включите, чтобы обойти проблемы с правильным определением контроллера.

### Как использовать wine-cachyos-opt

<Tabs>
    <TabItem label='Автономно'>
    Обычно запуска `/opt/wine-cachyos/bin/wine` вместо просто `wine` должно быть достаточно, чтобы приложение запустилось с использованием `wine-cachyos-opt`.

    Если требуется более строгая конфигурация, она может выглядеть так
    ```shell
    export PATH="/opt/wine-cachyos/bin/:$PATH"
    export WINEDLLPATH="/opt/wine-cachyos/lib/wine:/opt/wine-cachyos/lib32/wine:$WINEDLLPATH"
    export LD_LIBRARY_PATH="/opt/wine-cachyos/lib/:/opt/wine-cachyos/lib32/:$LD_LIBRARY_PATH"
    ```

    Если вы хотите использовать `winetricks` с `wine-cachyos-opt`, вы можете вызвать его следующим образом
    ```shell
    WINE=/opt/wine-cachyos/bin/wine WINEPRFIX=<ваш префикс> winetricks <команда>
    ```
    </TabItem>
    <TabItem label='Lutris'>
      :::note
      Второе изображение также относится к настройке для каждой игры.
      :::
      <MultipleImageComponent
      images={[
      import('~/assets/images/lutris-guide-1.png'),
      import('~/assets/images/lutris-guide-2.png')]}
      />
    </TabItem>
    <TabItem label='Heroic Games Launcher'>
      <MultipleImageComponent
      images={[
      import('~/assets/images/heroic-wine.png'),
      import('~/assets/images/heroic-wine-2.png'),
      import('~/assets/images/heroic-wine-3.png')]}
      />
    </TabItem>
</Tabs>

## Bottles

Bottles — это приложение, которое позволяет легко управлять префиксами Windows в ваших любимых дистрибутивах Linux.

Bottles также может использовать различные среды выполнения, такие как Lutris, и всем этим можно управлять в приложении. Bottles предлагает возможность игрового префикса.

Вы также можете устанавливать зависимости, добавлять EXE-файлы и использовать установщики в один клик для игровых приложений, таких как EA App или Battle.net.

```sh title="Как установить Bottles"
# Откройте терминал и выполните следующую команду:
sudo pacman -S bottles
```

*Если вы хотите узнать больше об этом, ознакомьтесь с их [документацией](https://docs.usebottles.com/).*

## Введение и советы по Lutris

Lutris служит центральным узлом для всех ваших игр в CachyOS.

С помощью Lutris вы можете эффективно управлять своими игровыми средами выполнения, включая Wine, Proton и эмуляторы.

- **Вы можете запускать игры через Lutris, просто нажав кнопку `Play`.**
- **Добавьте любую игру, нажав знак `+` в верхнем левом углу.**
- **Настройте магазин в `Источниках` на левой панели и подключите свою учетную запись, после чего он приступит к установке указанного магазина, и тогда вы сможете запускать игры из магазина, как это делается в Windows.**
- **И многое другое!**

### Игровые магазины, поддерживаемые в Lutris

- [EA App](https://lutris.net/games/ea-app/)
- [Epic Games Store](https://lutris.net/games/epic-games-store/)
- [GOG Galaxy](https://lutris.net/games/gog-galaxy/)
- [Steam](https://lutris.net/games/steam/)
- [Ubisoft Connect](https://lutris.net/games/ubisoft-connect/)

### Добавление параметра к игре

- Щелкните правой кнопкой мыши значок игры > `Configure` > `Game options` > `Arguments` > Добавьте любой необходимый аргумент.

## Поддержка трассировки лучей
В Arch Wiki уже есть подробные инструкции о том, как включить [трассировку лучей](https://wiki.archlinux.org/title/Hardware_raytracing) для различных аппаратных платформ.
- [Трассировка лучей на NVIDIA](https://wiki.archlinux.org/title/Hardware_raytracing#NVIDIA)
- [Трассировка лучей на AMD](https://wiki.archlinux.org/title/Hardware_raytracing#AMD)
- [Трассировка лучей на Intel](https://wiki.archlinux.org/title/Hardware_raytracing#Intel)

**С помощью этого руководства вы теперь готовы начать играть в CachyOS. Наслаждайтесь!**
