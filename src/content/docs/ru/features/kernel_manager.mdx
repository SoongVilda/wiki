---
title: Управление ядрами Linux и фреймворком Sched-ext с помощью CachyOS Kernel Manager
description: CachyOS Kernel Manager — это мощный инструмент для управления ядрами, позволяющий пользователям легко устанавливать или собирать собственные ядра.
---

import ImageComponent from '~/components/image-component.astro';

Установка ядра из репозитория
---------------------------------------

**CachyOS Kernel Manager упрощает установку и управление ядрами из любого репозитория Arch Linux.**

Чтобы установить ядро, запустите приложение `CachyOS Kernel Manager` и выберите нужное ядро, отметив флажок `[]` в списке всех доступных вариантов, а затем просто нажмите `Execute`, чтобы начать установку ядра.

<br />
<ImageComponent imgsrc={import('~/assets/images/cachyos-km1.png')} />

:::note
Кнопка `Execute` становится недоступной, если вы выбираете уже установленное ядро.
:::

Настройка и сборка пользовательского ядра CachyOS
---------------------------------

<br />
<ImageComponent imgsrc={import('~/assets/images/cachyos-km2.png')} />

**CachyOS Kernel Manager упрощает настройку и сборку пользовательского ядра CachyOS.**

:::note
CachyOS Kernel Manager специально разработан для сборки пользовательских ядер для **вариантов CachyOS** и не поддерживает сборку или настройку стандартного ядра Arch Linux или любого другого варианта.
:::

*Чтобы начать, откройте Kernel Manager и нажмите кнопку `Configure`, чтобы начать настройку различных параметров, таких как желаемый планировщик, частота тактов и многое другое. После того, как вы внесли желаемые изменения, нажмите кнопку `Build kernel`, чтобы начать сборку вашего пользовательского ядра CachyOS.*

**Доступные параметры конфигурации:**

* *`Custom package name`: **С помощью этой опции вы можете назвать свое ядро как угодно, например: `linux-custom-cachy`***
* *Планировщик (BORE, RC, RT, RT+BORE, EEVDF и BMQ)*
* *Включить конфигурацию CachyOS*
* *Настройка конфигурации через nconfig, menuconfig, xconfig или gconfig*
* *Включить/Отключить NUMA*
* *Включить/Отключить Modprobed-db*
* *KBUILD CFLAGS (-O3 или -O2)*
* *Губернатор производительности по умолчанию*
* *Включить BBR3*
* *Выбор частоты тактов (100Hz, 250Hz, 300Hz, 500Hz, 600Hz, 750Hz, 1000Hz)*
* *Режим без тактов (idle, periodic, full)*
* *Вытеснение (Full, Voluntary или Server)*
* *Transparent Hugepages (Always или Madvise)*
* *Включить/Отключить DAMON*
* *Включить/Отключить автоматическое определение архитектуры ЦП*
* *Применить оптимизацию ядра для конкретных архитектур ЦП*
* *Включить LTO (Full, Thin, No)*
* *Сборка модуля ZFS*
* *Сборка закрытого модуля NVIDIA*
* *Сборка открытого модуля NVIDIA*
* *Включить vmlinux с отладочной информацией/символами*
* *Загрузка/Сохранение предустановки конфигурации Kernel Manager: `(Только предустановки из самого менеджера)`*
* *Управление патчами ядра (поддержка удаленных и локальных)*

**После успешной сборки ядра вам будет предложено ввести пароль sudo для установки ядра.**

## Управление фреймворком Sched-ext

**Kernel Manager предоставляет графический интерфейс пользователя (GUI) для управления и контроля планировщиков sched-ext. Получите доступ к графическому интерфейсу, нажав кнопку `sched-ext scheduler config` в главном окне.**

<br />
<ImageComponent imgsrc={import('~/assets/images/cachyos-km3.png')} />

Этот графический интерфейс позволяет:

- **Переключаться между различными планировщиками sched-ext (scx).**
- **Включать или отключать службу планировщика.**
- **Проверять текущий работающий планировщик.**
- **Устанавливать флаги и профили планировщика. `В настоящее время профили поддерживают только bpfland и lavd.`**

Для этого Kernel Manager использует `scx_loader` с конфигурацией, хранящейся в:

`/etc/scx_loader.toml`. Для получения дополнительной информации о файле конфигурации `scx_loader` см. [эту документацию](https://github.com/sched-ext/scx/blob/main/rust/scx_loader/configuration.md).

- **Как работает `scx_loader`?**
    - После того, как вы выбрали планировщик и профиль, scx_loader запустит планировщик с выбранным профилем и сохранит эту конфигурацию в файл `/etc/scx_loader.toml`, чтобы обеспечить сохранение настроек после перезагрузки. Пример того, как будет выглядеть файл при выборе `scx_bpfland` с профилем `Gaming`:
        ```toml
        default_sched = "scx_bpfland"
        default_mode = "Gaming"

        [scheds.scx_bpfland]
        auto_mode = []
        gaming_mode = ["-m", "performance"]
        lowlatency_mode = ["-k", "-s", "5000", "-l", "5000"]
        powersave_mode = ["-m", "powersave"]
        ```

### Профили планировщика

- **Для чего нужны "профили"?**
  - Это предустановки для планировщика, которые изменяют флаги на основе проверенных комбинаций для повышения эффективности для конкретных случаев использования, таких как "Gaming".

**Ознакомьтесь с таблицей для более подробного обзора.**

#### Bpfland

|   Название профиля  	|  Флаги командной строки  	|                                                         Описание                                                         	|
|:---------------:	|:--------------------:	|:---------------------------------------------------------------------------------------------------------------------------:	|
| **Низкая задержка** 	| `-k -s 5000 -l 5000` 	| Предназначен для снижения задержки за счет пропускной способности. Подходит для приложений реального времени, таких как обработка аудио и мультимедиа. 	|
| **Игры**      	| `-m performance`  	| Оптимизирует для высокой производительности в играх. Приоритизирует P-ядра над E-ядрами на процессорах Intel и CCD на процессорах Ryzen X3D.         	|
| **Экономия энергии**  	| `-m powersave`       	| Приоритизирует энергоэффективность. Отдает предпочтение менее производительным ядрам (например, E-ядрам на Intel).                                          	|
| **Сервер**        | `-c 0`                | Отключает интерактивную классификацию задач в Bpfland, что делает его более подходящим для сервера, ожидается увеличение примерно на 2-3% в серверных нагрузках

#### LAVD

|       Название профиля       	| Флаги командной строки 	|                                                             Описание                                                            	|
|:------------------------:	|:------------------:	|:----------------------------------------------------------------------------------------------------------------------------------:	|
| **Игры и низкая задержка** 	|   `--performance`  	| Максимизирует производительность за счет использования всех доступных ядер, приоритизируя физические ядра.                                                   	|
|      **Экономия энергии**      	|    `--powersave`   	| Минимизирует энергопотребление, сохраняя при этом разумную производительность. Приоритизирует эффективные ядра и потоки над физическими ядрами. 	|
